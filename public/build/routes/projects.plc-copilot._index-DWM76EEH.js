import{b as E}from"/build/_shared/chunk-ZVN75CDP.js";import{B as F,C as I,H as L,m as S,t as f,w as M,z as C}from"/build/_shared/chunk-RSBDZNQN.js";import{b as N,f as w}from"/build/_shared/chunk-2QYNQQLQ.js";import{c as g,d as _,e as k}from"/build/_shared/chunk-MFPRU5OA.js";var a=g(_(),1);var e=g(k(),1);function D(){let[d,j]=(0,a.useState)([]),[l,T]=(0,a.useState)(""),[m,K]=(0,a.useState)(!1),[i,p]=(0,a.useState)([]),[A,x]=(0,a.useState)(null),[r,R]=(0,a.useState)(!1),v=(0,a.useRef)(null),P=(0,a.useRef)(null),c=(0,a.useRef)(null),h=N(),U=()=>{v.current?.scrollIntoView({behavior:"smooth"})};(0,a.useEffect)(()=>{U()},[d]),(0,a.useEffect)(()=>{try{let t=localStorage.getItem("plc_copilot_uploaded_files");t&&p(JSON.parse(t))}catch{}},[]),(0,a.useEffect)(()=>{try{localStorage.setItem("plc_copilot_uploaded_files",JSON.stringify(i))}catch{}},[i]);let y=async t=>{if(t.preventDefault(),!l.trim()||m)return;let s=Date.now().toString();if(window.innerWidth<1024)h(`/projects/plc-copilot/project/${s}?prompt=${encodeURIComponent(l.trim())}`);else{R(!0);let n={id:Date.now().toString(),content:l.trim(),role:"user",timestamp:new Date};j([n]),setTimeout(()=>{h(`/projects/plc-copilot/project/${s}?prompt=${encodeURIComponent(l.trim())}`)},800)}},$=t=>{let s=t.target.files;s&&(Array.from(s).forEach(async o=>{let n=Date.now().toString()+Math.random().toString(36).substr(2,9),u=null;try{u=await o.text()}catch{u=null}let H={id:n,name:o.name,size:o.size,type:o.type,content:u};p(b=>[...b,H]),x(n)}),c.current&&(c.current.value=""))},z=t=>{p(s=>s.filter(o=>o.id!==t)),x(s=>s===t?null:s)},W=t=>{if(t===0)return"0 Bytes";let s=1024,o=["Bytes","KB","MB","GB"],n=Math.floor(Math.log(t)/Math.log(s));return parseFloat((t/Math.pow(s,n)).toFixed(1))+" "+o[n]},B=t=>{t.key==="Enter"&&!t.shiftKey&&window.innerWidth>=1024&&(t.preventDefault(),y(t))};return(0,e.jsxs)("div",{className:"h-screen bg-gray-950 text-white flex flex-col relative overflow-hidden",children:[(0,e.jsx)("header",{className:`border-b border-gray-800 px-6 py-4 transition-all duration-700 flex-shrink-0 ${r?"opacity-50":"opacity-100"}`,children:(0,e.jsxs)("div",{className:"flex items-center justify-between max-w-4xl mx-auto",children:[(0,e.jsxs)("div",{className:"flex items-center gap-3",children:[(0,e.jsx)("div",{className:"w-8 h-8 bg-orange-500 rounded-lg flex items-center justify-center",children:(0,e.jsx)(f,{className:"w-5 h-5 text-white"})}),(0,e.jsxs)("div",{children:[(0,e.jsx)("h1",{className:"text-xl font-semibold",children:"PLC Copilot"}),(0,e.jsx)(E,{className:"mt-1"})]})]}),(0,e.jsxs)("div",{className:"flex items-center gap-2",children:[(0,e.jsx)("button",{className:"p-2 hover:bg-gray-800 rounded-lg transition-colors",children:(0,e.jsx)(C,{className:"w-5 h-5"})}),(0,e.jsx)(w,{to:"/projects/plc-copilot/session",className:"p-2 hover:bg-gray-800 rounded-lg transition-colors",children:(0,e.jsx)(I,{className:"w-5 h-5"})})]})]})}),(0,e.jsxs)("main",{className:"flex-1 flex relative min-h-0",children:[(0,e.jsx)("div",{className:`flex flex-col min-h-0 ${r?"lg:w-1/4 w-full transition-all duration-700 ease-in-out":"w-full"}`,children:(0,e.jsxs)("div",{className:"max-w-4xl mx-auto w-full h-full flex flex-col min-h-0",children:[(0,e.jsxs)("div",{className:"flex-1 overflow-y-auto px-6 py-8 min-h-0",children:[d.length===0?(0,e.jsxs)("div",{className:"text-center text-gray-400 mt-20",children:[(0,e.jsx)("div",{className:"w-16 h-16 bg-orange-500/10 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,e.jsx)(f,{className:"w-8 h-8 text-orange-500"})}),(0,e.jsx)("h2",{className:"text-xl font-medium text-white mb-2",children:"Welcome to PLC Copilot"}),(0,e.jsx)("p",{className:"text-sm",children:"Your intelligent assistant for PLC programming and automation tasks."}),(0,e.jsx)("p",{className:"text-sm mt-2",children:"Ask questions about ladder logic, function blocks, or troubleshooting."})]}):(0,e.jsxs)("div",{className:"space-y-6",children:[d.map(t=>(0,e.jsx)("div",{className:`flex ${t.role==="user"?"justify-end":"justify-start"}`,children:(0,e.jsxs)("div",{className:`max-w-[80%] rounded-lg px-4 py-3 ${t.role==="user"?"bg-orange-500 text-white":"bg-gray-800 text-gray-100"}`,children:[(0,e.jsx)("p",{className:"whitespace-pre-wrap",children:t.content}),(0,e.jsx)("time",{className:"text-xs opacity-70 mt-1 block",children:t.timestamp.toLocaleTimeString()})]})},t.id)),m&&(0,e.jsx)("div",{className:"flex justify-start",children:(0,e.jsx)("div",{className:"bg-gray-800 rounded-lg px-4 py-3",children:(0,e.jsxs)("div",{className:"flex items-center gap-2",children:[(0,e.jsx)("div",{className:"w-2 h-2 bg-orange-500 rounded-full animate-bounce"}),(0,e.jsx)("div",{className:"w-2 h-2 bg-orange-500 rounded-full animate-bounce",style:{animationDelay:"0.1s"}}),(0,e.jsx)("div",{className:"w-2 h-2 bg-orange-500 rounded-full animate-bounce",style:{animationDelay:"0.2s"}})]})})})]}),(0,e.jsx)("div",{ref:v})]}),(0,e.jsxs)("div",{className:"border-t border-gray-800 p-6 flex-shrink-0",children:[(0,e.jsxs)("form",{onSubmit:y,className:"relative",children:[i.length>0&&(0,e.jsx)("div",{className:"mb-3 flex flex-wrap gap-2",children:i.map(t=>(0,e.jsxs)("div",{className:"flex items-center gap-3 bg-gray-900 border border-gray-800 rounded-full px-3 py-2 text-sm",children:[(0,e.jsx)(S,{className:"w-4 h-4 text-gray-300"}),(0,e.jsx)("span",{className:"max-w-[220px] truncate text-white",children:t.name}),(0,e.jsx)("span",{className:"text-xs text-gray-400",children:t.type?.split("/").pop()?.toUpperCase()||""}),(0,e.jsx)("button",{onClick:()=>z(t.id),className:"text-gray-400 hover:text-red-400 ml-2",children:(0,e.jsx)(L,{className:"w-3 h-3"})})]},t.id))}),(0,e.jsxs)("div",{className:"relative",children:[(0,e.jsx)("textarea",{ref:P,value:l,onChange:t=>T(t.target.value),onKeyDown:B,placeholder:"Ask about PLC programming, ladder logic, or automation...",className:"w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-3 pr-24 resize-none focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-transparent text-white placeholder-gray-400",rows:2,style:{minHeight:"64px",maxHeight:"120px"}}),(0,e.jsx)("input",{ref:c,type:"file",multiple:!0,className:"hidden",onChange:$,accept:".txt,.pdf,.doc,.docx,.xls,.xlsx,.csv,.json,.xml,.plc,.l5x"}),(0,e.jsx)("button",{type:"button",onClick:()=>c.current?.click(),className:"absolute right-12 top-1/2 transform -translate-y-1/2 p-2 text-gray-400 hover:text-orange-500 transition-colors",children:(0,e.jsx)(M,{className:"w-4 h-4"})}),(0,e.jsx)("button",{type:"submit",disabled:!l.trim()||m,className:"absolute right-3 top-1/2 transform -translate-y-1/2 p-2 bg-orange-500 text-white rounded-md hover:bg-orange-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:(0,e.jsx)(F,{className:"w-4 h-4"})})]})]}),(0,e.jsx)("p",{className:"text-xs text-gray-500 mt-2 text-center hidden lg:block",children:"Press Enter to send, Shift+Enter for new line"})]})]})}),r&&(0,e.jsx)("div",{className:"hidden lg:block w-1 bg-gray-800 animate-pulse"}),r&&(0,e.jsx)("div",{className:"hidden lg:block flex-1 bg-gray-900 opacity-20"})]})]})}export{D as default};
